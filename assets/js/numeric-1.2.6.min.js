"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,n){var e,i,t;for(void 0===n&&(n=15),i=.5,e=new Date;;){for(t=i*=2;3<t;t-=4)r(),r(),r(),r();for(;0<t;)r(),t--;if(n<new Date-e)break}for(t=i;3<t;t-=4)r(),r(),r(),r();for(;0<t;)r(),t--;return 1e3*(3*i-1)/(new Date-e)},numeric._myIndexOf=function(r){for(var n=this.length,e=0;e<n;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){var a=[];return function r(n){if(void 0===n)return a.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return a.push('"'+n+'"'),!1;if("boolean"==typeof n)return a.push(n.toString()),!1;if("number"==typeof n){for(var e=function r(n){if(0===n)return"0";if(isNaN(n))return"NaN";if(n<0)return"-"+r(-n);if(isFinite(n)){var e=Math.floor(Math.log(n)/Math.log(10)),i=n/Math.pow(10,e),t=i.toPrecision(numeric.precision);return 10===parseFloat(t)&&(e++,t=(i=1).toPrecision(numeric.precision)),parseFloat(t).toString()+"e"+e.toString()}return"Infinity"}(n),i=n.toPrecision(numeric.precision),t=parseFloat(n.toString()).toString(),u=[e,i,t,parseFloat(i).toString(),parseFloat(t).toString()],o=1;o<u.length;o++)u[o].length<e.length&&(e=u[o]);return a.push(Array(numeric.precision+8-e.length).join(" ")+e),!1}if(null===n)return a.push("null"),!1;if("function"==typeof n){a.push(n.toString());var c=!1;for(o in n)n.hasOwnProperty(o)&&(c?a.push(",\n"):a.push("\n{"),c=!0,a.push(o),a.push(": \n"),r(n[o]));return c&&a.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return a.push("...Large Array..."),!0;for(c=!1,a.push("["),o=0;o<n.length;o++)0<o&&(a.push(","),c&&a.push("\n ")),c=r(n[o]);return a.push("]"),!0}a.push("{");c=!1;for(o in n)n.hasOwnProperty(o)&&(c&&a.push(",\n"),c=!0,a.push(o),a.push(": \n"),r(n[o]));return a.push("}"),!0}(r),a.join("")},numeric.parseDate=function(r){return function r(n){if("string"==typeof n)return Date.parse(n.replace(/-/g,"/"));if(n instanceof Array){for(var e=[],i=0;i<n.length;i++)e[i]=r(n[i]);return e}throw new Error("parseDate: parameter must be arrays of strings")}(r)},numeric.parseFloat=function(r){return function r(n){if("string"==typeof n)return parseFloat(n);if(n instanceof Array){for(var e=[],i=0;i<n.length;i++)e[i]=r(n[i]);return e}throw new Error("parseFloat: parameter must be arrays of strings")}(r)},numeric.parseCSV=function(r){for(var n,e,i=r.split("\n"),t=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=0,a=0;a<i.length;a++){var f,m=(i[a]+",").match(u);if(0<m.length){for(t[c]=[],n=0;n<m.length;n++)f=(e=m[n]).substr(0,e.length-1),o.test(f)?t[c][n]=parseFloat(f):t[c][n]=f;c++}}return t},numeric.toCSV=function(r){for(var n,e,i=numeric.dim(r),t=i[0],u=(i[1],[]),o=0;o<t;o++){for(e=[],n=0;n<t;n++)e[n]=r[o][n].toString();u[o]=e.join(", ")}return u.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r,n,e){void 0===n&&(n=0),void 0===e&&(e=r.length);for(var i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],t=-1,u=(r.length,n);u<e;u++)t=t>>>8^i[255&(t^r[u])];return-1^t}var e,i,t,u,o,c,a,f,m,s=r[0].length,h=r[0][0].length,l=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,h>>24&255,h>>16&255,h>>8&255,255&h,s>>24&255,s>>16&255,s>>8&255,255&s,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29],p=n(l,12,29);for(l[29]=p>>24&255,l[30]=p>>16&255,l[31]=p>>8&255,l[32]=255&p,e=1,a=i=0;a<s;a++){for(a<s-1?l.push(0):l.push(1),o=3*h+1+(0===a)&255,c=3*h+1+(0===a)>>8&255,l.push(o),l.push(c),l.push(255&~o),l.push(255&~c),0===a&&l.push(0),f=0;f<h;f++)for(t=0;t<3;t++)i=(i+(e=(e+(o=255<(o=r[t][a][f])?255:o<0?0:Math.round(o)))%65521))%65521,l.push(o);l.push(0)}return m=(i<<16)+e,l.push(m>>24&255),l.push(m>>16&255),l.push(m>>8&255),l.push(255&m),u=l.length-41,l[33]=u>>24&255,l[34]=u>>16&255,l[35]=u>>8&255,l[36]=255&u,p=n(l,37),l.push(p>>24&255),l.push(p>>16&255),l.push(p>>8&255),l.push(255&p),l.push(0),l.push(0),l.push(0),l.push(0),l.push(73),l.push(69),l.push(78),l.push(68),l.push(174),l.push(66),l.push(96),l.push(130),"data:image/png;base64,"+function(r){for(var n,e,i,t,u,o,c=r.length,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="",m=0;m<c;m+=3)t=((3&(n=r[m]))<<4)+((e=r[m+1])>>4),u=((15&e)<<2)+((i=r[m+2])>>6),o=63&i,c<=m+1?u=o=64:c<=m+2&&(o=64),f+=a.charAt(n>>2)+a.charAt(t)+a.charAt(u)+a.charAt(o);return f}(l)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n;return"object"==typeof r?"object"==typeof(n=r[0])?"object"==typeof n[0]?numeric._dim(r):[r.length,n.length]:[r.length]:[]},numeric.mapreduce=function(r,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(n,e){var i,t;if(n instanceof Array&&e instanceof Array){if((t=n.length)!==e.length)return!1;for(i=0;i<t;i++)if(n[i]!==e[i]){if("object"!=typeof n[i])return!1;if(!r(n[i],e[i]))return!1}return!0}return!1},numeric.rep=function(r,n,e){void 0===e&&(e=0);var i,t=r[e],u=Array(t);if(e===r.length-1){for(i=t-2;0<=i;i-=2)u[i+1]=n,u[i]=n;return-1===i&&(u[0]=n),u}for(i=t-1;0<=i;i--)u[i]=numeric.rep(r,n,e+1);return u},numeric.dotMMsmall=function(r,n){for(var e,i,t,u,o,c,a=r.length,f=n.length,m=n[0].length,s=Array(a),h=a-1;0<=h;h--){for(t=Array(m),u=r[h],i=m-1;0<=i;i--){for(o=u[f-1]*n[f-1][i],e=f-2;1<=e;e-=2)c=e-1,o+=u[e]*n[e][i]+u[c]*n[c][i];0===e&&(o+=u[0]*n[0][i]),t[i]=o}s[h]=t}return s},numeric._getCol=function(r,n,e){for(var i=r.length-1;0<i;--i)e[i]=r[i][n],e[--i]=r[i][n];0===i&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,i,t,u=numeric._getCol,o=n.length,c=Array(o),a=r.length,f=n[0].length,m=new Array(a),s=numeric.dotVV;for(--o,i=--a;-1!==i;--i)m[i]=Array(f);for(i=--f;-1!==i;--i)for(u(n,i,c),t=a;-1!==t;--t)e=r[t],m[t][i]=s(e,c);return m},numeric.dotMV=function(r,n){for(var e=r.length,i=(n.length,Array(e)),t=numeric.dotVV,u=e-1;0<=u;u--)i[u]=t(r[u],n);return i},numeric.dotVM=function(r,n){for(var e,i,t,u=r.length,o=n[0].length,c=Array(o),a=o-1;0<=a;a--){for(i=r[u-1]*n[u-1][a],e=u-2;1<=e;e-=2)t=e-1,i+=r[e]*n[e][a]+r[t]*n[t][a];0===e&&(i+=r[0]*n[0][a]),c[a]=i}return c},numeric.dotVV=function(r,n){for(var e,i=r.length,t=r[i-1]*n[i-1],u=i-2;1<=u;u-=2)e=u-1,t+=r[u]*n[u]+r[e]*n[e];return 0===u&&(t+=r[0]*n[0]),t},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){for(var n,e,i,t=r.length,u=Array(t),o=t-1;0<=o;o--){for(i=Array(t),n=o+2,e=t-1;n<=e;e-=2)i[e]=0,i[e-1]=0;for(o<e&&(i[e]=0),i[o]=r[o],e=o-1;1<=e;e-=2)i[e]=0,i[e-1]=0;0===e&&(i[0]=0),u[o]=i}return u},numeric.getDiag=function(r){for(var n=Math.min(r.length,r[0].length),e=Array(n),i=n-1;1<=i;--i)e[i]=r[i][i],e[--i]=r[i][i];return 0===i&&(e[0]=r[0][0]),e},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,n,e){void 0===e&&(e="");for(var i,t=[],u=/\[i\]$/,o="",c=!1,a=0;a<r.length;a++)u.test(r[a])?o=i=r[a].substring(0,r[a].length-3):i=r[a],"ret"===i&&(c=!0),t.push(i);return t[r.length]="_s",t[r.length+1]="_k",t[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+o+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(c?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,t)},numeric.pointwise2=function(r,n,e){void 0===e&&(e="");for(var i,t=[],u=/\[i\]$/,o="",c=!1,a=0;a<r.length;a++)u.test(r[a])?o=i=r[a].substring(0,r[a].length-3):i=r[a],"ret"===i&&(c=!0),t.push(i);return t[r.length]="var _n = "+o+".length;\nvar i"+(c?"":", ret = Array(_n)")+";\n"+e+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,t)},numeric._biforeach=function r(n,e,i,t,u){if(t!==i.length-1)for(var o=i[t]-1;0<=o;o--)r("object"==typeof n?n[o]:n,"object"==typeof e?e[o]:e,i,t+1,u);else u(n,e)},numeric._biforeach2=function r(n,e,i,t,u){if(t===i.length-1)return u(n,e);for(var o=i[t],c=Array(o),a=o-1;0<=a;--a)c[a]=r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,i,t+1,u);return c},numeric._foreach=function r(n,e,i,t){if(i!==e.length-1)for(var u=e[i]-1;0<=u;u--)r(n[u],e,i+1,t);else t(n)},numeric._foreach2=function r(n,e,i,t){if(i===e.length-1)return t(n);for(var u=e[i],o=Array(u),c=u-1;0<=c;c--)o[c]=r(n[c],e,i+1,t);return o},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){for(var i,r,n,e,t=0;t<numeric.mathfuns2.length;++t)i=numeric.mathfuns2[t],numeric.ops2[i]=i;for(t in numeric.ops2){numeric.ops2.hasOwnProperty(t)&&(i=numeric.ops2[t],n="",e=-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(n="var "+i+" = Math."+i+";\n",r=function(r,n,e){return r+" = "+i+"("+n+","+e+")"},function(r,n){return r+" = "+i+"("+r+","+n+")"}):(r=function(r,n,e){return r+" = "+n+" "+i+" "+e},numeric.opseq.hasOwnProperty(t+"eq")?function(r,n){return r+" "+i+"= "+n}:function(r,n){return r+" = "+r+" "+i+" "+n}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),n),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),n),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),n),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+e("x","y")+"\n}\nreturn x;\n"),numeric[i]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],e("ret[i]","x[i]"),n),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],e("ret[i]","x"),n),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n'))}for(t=0;t<numeric.mathfuns2.length;++t)i=numeric.mathfuns2[t],delete numeric.ops2[i];for(t=0;t<numeric.mathfuns.length;++t)i=numeric.mathfuns[t],numeric.ops1[i]=i;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(n="",i=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(i)&&(n="var "+i+" = Math."+i+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+i+"(ret[i]);",n),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+i+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+i+"(x[i]);",n),numeric[t]=Function("x",'if(typeof x !== "object") return '+i+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)i=numeric.mathfuns[t],delete numeric.ops1[i];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(i=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(i[0],i[1]),numeric[t]=Function("x","s","k",i[1]+'if(typeof x !== "object") {    xi = x;\n'+i[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+i[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,n){return"object"==typeof r?"object"==typeof n?numeric.truncVV(r,n):numeric.truncVS(r,n):"object"==typeof n?numeric.truncSV(r,n):Math.round(r/n)*n},numeric.inv=function(r){for(var n,e,i,t,u,o=numeric.dim(r),c=Math.abs,a=o[0],f=o[1],m=numeric.clone(r),s=numeric.identity(a),h=0;h<f;++h){for(var l=-1,p=-1,y=h;y!==a;++y)p<(u=c(m[y][h]))&&(l=y,p=u);for(e=m[l],m[l]=m[h],m[h]=e,t=s[l],s[l]=s[h],s[h]=t,r=e[h],u=h;u!==f;++u)e[u]/=r;for(u=f-1;-1!==u;--u)t[u]/=r;for(y=a-1;-1!==y;--y)if(y!==h){for(n=m[y],i=s[y],r=n[h],u=h+1;u!==f;++u)n[u]-=e[u]*r;for(u=f-1;0<u;--u)i[u]-=t[u]*r,i[--u]-=t[u]*r;0===u&&(i[0]-=t[0]*r)}}return s},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");for(var e,i,t,u,o,c,a,f=n[0],m=1,s=numeric.clone(r),h=0;h<f-1;h++){for(e=(i=h)+1;e<f;e++)Math.abs(s[e][h])>Math.abs(s[i][h])&&(i=e);for(i!==h&&(c=s[i],s[i]=s[h],s[h]=c,m*=-1),t=s[h],e=h+1;e<f;e++){for(o=(u=s[e])[h]/t[h],i=h+1;i<f-1;i+=2)a=i+1,u[i]-=t[i]*o,u[a]-=t[a]*o;i!==f&&(u[i]-=t[i]*o)}if(0===t[h])return 0;m*=t[h]}return m*s[h][h]},numeric.transpose=function(r){for(var n,e,i,t,u=r.length,o=r[0].length,c=Array(o),a=0;a<o;a++)c[a]=Array(u);for(n=u-1;1<=n;n-=2){for(i=r[n],e=r[n-1],a=o-1;1<=a;--a)(t=c[a])[n]=i[a],t[n-1]=e[a],(t=c[--a])[n]=i[a],t[n-1]=e[a];0===a&&((t=c[0])[n]=i[0],t[n-1]=e[0])}if(0===n){for(e=r[0],a=o-1;1<=a;--a)c[a][0]=e[a],c[--a][0]=e[a];0===a&&(c[0][0]=e[0])}return c},numeric.negtranspose=function(r){for(var n,e,i,t,u=r.length,o=r[0].length,c=Array(o),a=0;a<o;a++)c[a]=Array(u);for(n=u-1;1<=n;n-=2){for(i=r[n],e=r[n-1],a=o-1;1<=a;--a)(t=c[a])[n]=-i[a],t[n-1]=-e[a],(t=c[--a])[n]=-i[a],t[n-1]=-e[a];0===a&&((t=c[0])[n]=-i[0],t[n-1]=-e[0])}if(0===n){for(e=r[0],a=o-1;1<=a;--a)c[a][0]=-e[a],c[--a][0]=-e[a];0===a&&(c[0][0]=-e[0])}return c},numeric._random=function r(n,e){var i,t,u=n[e],o=Array(u);if(e===n.length-1){for(t=Math.random,i=u-1;1<=i;i-=2)o[i]=t(),o[i-1]=t();return 0===i&&(o[0]=t()),o}for(i=u-1;0<=i;i--)o[i]=r(n,e+1);return o},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,n,e){if(void 0===e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];for(var i=Array(e),t=--e;0<=t;t--)i[t]=(t*n+(e-t)*r)/e;return i},numeric.getBlock=function(r,c,a){var f=numeric.dim(r);return function r(n,e){var i,t=c[e],u=a[e]-t,o=Array(u);if(e===f.length-1){for(i=u;0<=i;i--)o[i]=n[i+t];return o}for(i=u;0<=i;i--)o[i]=r(n[i+t],e+1);return o}(r,0)},numeric.setBlock=function(r,c,a,n){var f=numeric.dim(r);return function r(n,e,i){var t,u=c[i],o=a[i]-u;if(i===f.length-1)for(t=o;0<=t;t--)n[t+u]=e[t];for(t=o;0<=t;t--)r(n[t+u],e[t],i+1)}(r,n,0),r},numeric.getRange=function(r,n,e){for(var i,t,u,o=n.length,c=e.length,a=Array(o),f=o-1;-1!==f;--f)for(a[f]=Array(c),t=a[f],u=r[n[f]],i=c-1;-1!==i;--i)t[i]=u[e[i]];return a},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);for(var e,i,t=n[0],u=n[1],o=0,c=0,a=0;a<t;++a)o+=r[a][0].length;for(e=0;e<u;++e)c+=r[0][e][0].length;var f=Array(o);for(a=0;a<o;++a)f[a]=Array(c);var m,s,h,l,p,y=0;for(a=0;a<t;++a){for(m=c,e=u-1;-1!==e;--e)for(m-=(i=r[a][e])[0].length,h=i.length-1;-1!==h;--h)for(p=i[h],s=f[y+h],l=p.length-1;-1!==l;--l)s[m+l]=p[l];y+=r[a][0].length}return f},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),i=numeric.dim(n);if(1!==e.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");for(var t,u,o,c=e[0],a=i[0],f=Array(c),m=c-1;0<=m;m--){for(t=Array(a),o=r[m],u=a-1;3<=u;--u)t[u]=o*n[u],t[--u]=o*n[u],t[--u]=o*n[u],t[--u]=o*n[u];for(;0<=u;)t[u]=o*n[u],--u;f[m]=t}return f},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,i,t){var u;numeric.indexOf;if("string"!=typeof t)for(u in t="",numeric)numeric.hasOwnProperty(u)&&(0<=r.indexOf(u)||0<=n.indexOf(u)||0<=e.indexOf(u)||0<=i.indexOf(u))&&1<u.length&&(t+="var "+u+" = numeric."+u+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+t+"\nif(x.y) {  if(y.y) {    return new numeric.T("+i+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new T(n(1,this.x))},numeric.T.prototype.div=function(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var n=numeric.div;return this.y?new numeric.T(n(this.x,r.x),n(this.y,r.x)):new numeric.T(n(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if(void 0===r.y)return new numeric.T(numeric.inv(r.x));var n,e,i,t,u,o,c,a,f,m,s,h,l,p,y,g,d,v,x=r.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),M=numeric.clone(r.x),k=numeric.clone(r.y);for(f=0;f<x;f++){for(h=(p=M[f][f])*p+(y=k[f][f])*y,m=(s=f)+1;m<x;m++)h<(l=(p=M[m][f])*p+(y=k[m][f])*y)&&(s=m,h=l);for(s!==f&&(v=M[f],M[f]=M[s],M[s]=v,v=k[f],k[f]=k[s],k[s]=v,v=b[f],b[f]=b[s],b[s]=v,v=w[f],w[f]=w[s],w[s]=v),n=M[f],e=k[f],u=b[f],o=w[f],p=n[f],y=e[f],m=f+1;m<x;m++)g=n[m],d=e[m],n[m]=(g*p+d*y)/h,e[m]=(d*p-g*y)/h;for(m=0;m<x;m++)g=u[m],d=o[m],u[m]=(g*p+d*y)/h,o[m]=(d*p-g*y)/h;for(m=f+1;m<x;m++){for(i=M[m],t=k[m],c=b[m],a=w[m],p=i[f],y=t[f],s=f+1;s<x;s++)g=n[s],d=e[s],i[s]-=g*p-d*y,t[s]-=d*p+g*y;for(s=0;s<x;s++)g=u[s],d=o[s],c[s]-=g*p-d*y,a[s]-=d*p+g*y}}for(f=x-1;0<f;f--)for(u=b[f],o=w[f],m=f-1;0<=m;m--)for(c=b[m],a=w[m],p=M[m][f],y=k[m][f],s=x-1;0<=s;s--)g=u[s],d=o[s],c[s]-=p*g-y*d,a[s]-=p*d+y*g;return new numeric.T(b,w)},numeric.T.prototype.get=function(r){var n,e=this.x,i=this.y,t=0,u=r.length;if(i){for(;t<u;)e=e[n=r[t]],i=i[n],t++;return new numeric.T(e,i)}for(;t<u;)e=e[n=r[t]],t++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,i=this.x,t=this.y,u=0,o=r.length,c=n.x,a=n.y;if(0===o)return a?this.y=a:t&&(this.y=void 0),this.x=i,this;if(a){for(t||(t=numeric.rep(numeric.dim(i),0),this.y=t);u<o-1;)i=i[e=r[u]],t=t[e],u++;return i[e=r[u]]=c,t[e]=a,this}if(t){for(;u<o-1;)i=i[e=r[u]],t=t[e],u++;return(i[e=r[u]]=c)instanceof Array?t[e]=numeric.rep(numeric.dim(c),0):t[e]=0,this}for(;u<o-1;)i=i[e=r[u]],u++;return i[e=r[u]]=c,this},numeric.T.prototype.getRows=function(r,n){for(var e,i=n-r+1,t=Array(i),u=this.x,o=this.y,c=r;c<=n;c++)t[c-r]=u[c];if(o){for(e=Array(i),c=r;c<=n;c++)e[c-r]=o[c];return new numeric.T(t,e)}return new numeric.T(t)},numeric.T.prototype.setRows=function(r,n,e){for(var i=this.x,t=this.y,u=e.x,o=e.y,c=r;c<=n;c++)i[c]=u[c-r];if(o)for(t||(t=numeric.rep(numeric.dim(i),0),this.y=t),c=r;c<=n;c++)t[c]=o[c-r];else if(t)for(c=r;c<=n;c++)t[c]=numeric.rep([u[c-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,i=this.y,t=n.x,u=n.y;return e[r]=t,u?(i||(i=numeric.rep(numeric.dim(e),0),this.y=i),i[r]=u):i=i&&numeric.rep([t.length],0),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,i=this.y,t=numeric.getBlock;return i?new numeric.T(t(e,r,n),t(i,r,n)):new numeric.T(t(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var i=this.x,t=this.y,u=numeric.setBlock,o=e.x,c=e.y;if(c)return t||(this.y=numeric.rep(numeric.dim(this),0),t=this.y),u(i,r,n,o),u(t,r,n,c),this;u(i,r,n,o),t&&u(t,r,n,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var i=n.x,t=n.y,u=numeric.rep;return t?new e(u(r,i),u(r,t)):new e(u(r,i))},numeric.T.diag=function(r){r instanceof numeric.T||(r=new numeric.T(r));var n=r.x,e=r.y,i=numeric.diag;return e?new numeric.T(i(n),i(e)):new numeric.T(i(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=(0<=r[0]?1:-1)*numeric.norm2(r);n[0]+=e;var i=numeric.norm2(n);if(0===i)throw new Error("eig: internal error");return numeric.div(n,i)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");for(var e,i,t,u,o,c,a,f,m,s=n[0],h=numeric.clone(r),l=numeric.identity(s),p=0;p<s-2;p++){for(t=Array(s-p-1),e=p+1;e<s;e++)t[e-p-1]=h[e][p];if(0<numeric.norm2(t)){for(u=numeric.house(t),o=numeric.getBlock(h,[p+1,p],[s-1,s-1]),c=numeric.tensor(u,numeric.dot(u,o)),e=p+1;e<s;e++)for(a=h[e],f=c[e-p-1],i=p;i<s;i++)a[i]-=2*f[i-p];for(o=numeric.getBlock(h,[0,p+1],[s-1,s-1]),c=numeric.tensor(numeric.dot(o,u),u),e=0;e<s;e++)for(a=h[e],f=c[e],i=p+1;i<s;i++)a[i]-=2*f[i-p-1];for(o=Array(s-p-1),e=p+1;e<s;e++)o[e-p-1]=l[e];for(c=numeric.tensor(u,numeric.dot(u,o)),e=p+1;e<s;e++)for(m=l[e],f=c[e-p-1],i=0;i<s;i++)m[i]-=2*f[i]}}return{H:h,Q:l}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(r,n){void 0===n&&(n=1e4),r=numeric.clone(r);numeric.clone(r);var e,i,t,u,o,c,a,f,m=numeric.dim(r)[0],s=numeric.identity(m);if(m<3)return{Q:s,B:[[0,m-1]]};for(var h=numeric.epsilon,l=0;l<n;l++){for(a=0;a<m-1;a++)if(Math.abs(r[a+1][a])<h*(Math.abs(r[a][a])+Math.abs(r[a+1][a+1]))){for(var p=numeric.QRFrancis(numeric.getBlock(r,[0,0],[a,a]),n),y=numeric.QRFrancis(numeric.getBlock(r,[a+1,a+1],[m-1,m-1]),n),g=Array(a+1),d=0;d<=a;d++)g[d]=s[d];for(o=numeric.dot(p.Q,g),d=0;d<=a;d++)s[d]=o[d];for(g=Array(m-a-1),d=a+1;d<m;d++)g[d-a-1]=s[d];for(o=numeric.dot(y.Q,g),d=a+1;d<m;d++)s[d]=o[d-a-1];return{Q:s,B:p.B.concat(numeric.add(y.B,a+1))}}var v,x,b,w,M,k=r[m-2][m-2],A=r[m-2][m-1],T=r[m-1][m-2],j=k+(w=r[m-1][m-1]),S=k*w-A*T;for(b=numeric.getBlock(r,[0,0],[2,2]),e=[(b=4*S<=j*j?(v=.5*(j+Math.sqrt(j*j-4*S)),x=.5*(j-Math.sqrt(j*j-4*S)),numeric.add(numeric.sub(numeric.dot(b,b),numeric.mul(b,v+x)),numeric.diag(numeric.rep([3],v*x)))):numeric.add(numeric.sub(numeric.dot(b,b),numeric.mul(b,j)),numeric.diag(numeric.rep([3],S))))[0][0],b[1][0],b[2][0]],i=numeric.house(e),g=[r[0],r[1],r[2]],o=numeric.tensor(i,numeric.dot(i,g)),d=0;d<3;d++)for(u=r[d],c=o[d],f=0;f<m;f++)u[f]-=2*c[f];for(g=numeric.getBlock(r,[0,0],[m-1,2]),o=numeric.tensor(numeric.dot(g,i),i),d=0;d<m;d++)for(u=r[d],c=o[d],f=0;f<3;f++)u[f]-=2*c[f];for(g=[s[0],s[1],s[2]],o=numeric.tensor(i,numeric.dot(i,g)),d=0;d<3;d++)for(t=s[d],c=o[d],f=0;f<m;f++)t[f]-=2*c[f];for(a=0;a<m-2;a++){for(f=a;f<=a+1;f++)if(Math.abs(r[f+1][f])<h*(Math.abs(r[f][f])+Math.abs(r[f+1][f+1]))){p=numeric.QRFrancis(numeric.getBlock(r,[0,0],[f,f]),n),y=numeric.QRFrancis(numeric.getBlock(r,[f+1,f+1],[m-1,m-1]),n);for(g=Array(f+1),d=0;d<=f;d++)g[d]=s[d];for(o=numeric.dot(p.Q,g),d=0;d<=f;d++)s[d]=o[d];for(g=Array(m-f-1),d=f+1;d<m;d++)g[d-f-1]=s[d];for(o=numeric.dot(y.Q,g),d=f+1;d<m;d++)s[d]=o[d-f-1];return{Q:s,B:p.B.concat(numeric.add(y.B,f+1))}}for(M=Math.min(m-1,a+3),e=Array(M-a),d=a+1;d<=M;d++)e[d-a-1]=r[d][a];for(i=numeric.house(e),g=numeric.getBlock(r,[a+1,a],[M,m-1]),o=numeric.tensor(i,numeric.dot(i,g)),d=a+1;d<=M;d++)for(u=r[d],c=o[d-a-1],f=a;f<m;f++)u[f]-=2*c[f-a];for(g=numeric.getBlock(r,[0,a+1],[m-1,M]),o=numeric.tensor(numeric.dot(g,i),i),d=0;d<m;d++)for(u=r[d],c=o[d],f=a+1;f<=M;f++)u[f]-=2*c[f-a-1];for(g=Array(M-a),d=a+1;d<=M;d++)g[d-a-1]=s[d];for(o=numeric.tensor(i,numeric.dot(i,g)),d=a+1;d<=M;d++)for(t=s[d],c=o[d-a-1],f=0;f<m;f++)t[f]-=2*c[f]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){for(var e,i,t,u,o,c,a,f,m,s,h,l,p,y,g=numeric.toUpperHessenberg(r),d=numeric.QRFrancis(g.H,n),v=numeric.T,x=r.length,b=d.B,w=numeric.dot(d.Q,numeric.dot(g.H,numeric.transpose(d.Q))),M=new v(numeric.dot(d.Q,g.Q)),k=b.length,A=Math.sqrt,T=0;T<k;T++)if((e=b[T][0])!==b[T][1]){if(_=e+1,t=w[e][e],u=w[e][_],o=w[_][e],c=w[_][_],0===u&&0===o)continue;i=0<=(f=(a=-t-c)*a-4*(t*c-u*o))?new v([[l=(y=o*o+(c-(m=a<0?-.5*(a-A(f)):-.5*(a+A(f))))*(c-m))<(p=(t-m)*(t-m)+u*u)?(h=(t-m)/(p=A(p)),u/p):(h=o/(y=A(y)),(c-m)/y),-h],[h,l]]):(m=-.5*a,s=.5*A(-f),(y=o*o+(c-m)*(c-m))<(p=(t-m)*(t-m)+u*u)?(h=(t-m)/(p=A(p+s*s)),l=u/p,m=0,s/=p):(h=o/(y=A(y+s*s)),l=(c-m)/y,m=s/y,s=0),new v([[l,-h],[h,l]],[[m,s],[s,-m]])),M.setRows(e,_,i.dot(M.getRows(e,_)))}for(var j=M.dot(r).dot(M.transjugate()),x=r.length,S=numeric.T.identity(x),_=0;_<x;_++)if(0<_)for(T=_-1;0<=T;T--){var V=j.get([T,T]),P=j.get([_,_]);numeric.neq(V.x,P.x)||numeric.neq(V.y,P.y)?(m=j.getRow(T).getBlock([T],[_-1]),s=S.getRow(_).getBlock([T],[_-1]),S.set([_,T],j.get([T,_]).neg().sub(m.dot(s)).div(V.sub(P)))):S.setRow(_,S.getRow(T))}for(_=0;_<x;_++)m=S.getRow(_),S.setRow(_,m.div(m.norm2()));return S=S.transpose(),S=M.transjugate().dot(S),{lambda:j.getDiag(),E:S}},numeric.ccsSparse=function(r){for(var n,e,i=r.length,t=[],u=i-1;-1!==u;--u)for(e in n=r[u]){for(e=parseInt(e);e>=t.length;)t[t.length]=0;0!==n[e]&&t[e]++}var o=t.length,c=Array(o+1);for(u=c[0]=0;u<o;++u)c[u+1]=c[u]+t[u];var a=Array(c[o]),f=Array(c[o]);for(u=i-1;-1!==u;--u)for(e in n=r[u])0!==n[e]&&(t[e]--,a[c[e]+t[e]]=u,f[c[e]+t[e]]=n[e]);return[c,a,f]},numeric.ccsFull=function(r){for(var n,e,i,t=r[0],u=r[1],o=r[2],c=numeric.ccsDim(r),a=c[0],f=c[1],m=numeric.rep([a,f],0),s=0;s<f;s++)for(e=t[s],i=t[s+1],n=e;n<i;++n)m[u[n]][s]=o[n];return m},numeric.ccsTSolve=function(r,n,e,i,t){function u(r){var n;if(0===e[r]){for(e[r]=1,n=l[r];n<l[r+1];++n)u(p[n]);t[v]=r,++v}}var o,c,a,f,m,s,h,l=r[0],p=r[1],y=r[2],g=l.length-1,d=Math.max,v=0;for(void 0===i&&(e=numeric.rep([g],0)),void 0===i&&(i=numeric.linspace(0,e.length-1)),void 0===t&&(t=[]),o=i.length-1;-1!==o;--o)u(i[o]);for(t.length=v,o=t.length-1;-1!==o;--o)e[t[o]]=0;for(o=i.length-1;-1!==o;--o)c=i[o],e[c]=n[c];for(o=t.length-1;-1!==o;--o){for(c=t[o],a=l[c],f=d(l[c+1],a),m=a;m!==f;++m)if(p[m]===c){e[c]/=y[m];break}for(h=e[c],m=a;m!==f;++m)(s=p[m])!==c&&(e[s]-=h*y[m])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,i,t,u){var o,c,a,f=0,m=t.length,s=this.k,h=this.k1,l=this.j;if(0===i[r])for(i[r]=1,l[0]=r,s[0]=c=n[r],h[0]=a=n[r+1];;)if(a<=c){if(t[m]=l[f],0===f)return;++m,c=s[--f],a=h[f]}else 0===i[o=u[e[c]]]?(i[o]=1,s[f]=c,c=n[l[++f]=o],h[f]=a=n[o+1]):++c},numeric.ccsLPSolve=function(r,n,e,i,t,u,o){var c,a,f,m,s,h,l,p=r[0],y=r[1],g=r[2],d=(p.length,n[0]),v=n[1],x=n[2],b=d[t],w=d[t+1];for(i.length=0,c=b;c<w;++c)o.dfs(u[v[c]],p,y,e,i,u);for(c=i.length-1;-1!==c;--c)e[i[c]]=0;for(c=b;c!==w;++c)e[a=u[v[c]]]=x[c];for(c=i.length-1;-1!==c;--c){for(f=p[a=i[c]],m=p[a+1],s=f;s<m;++s)if(u[y[s]]===a){e[a]/=g[s];break}for(l=e[a],s=f;s<m;++s)(h=u[y[s]])!==a&&(e[h]-=l*g[s])}return e},numeric.ccsLUP1=function(r,n){var e,i,t,u,o,c,a,f=r[0].length-1,m=[numeric.rep([1+f],0),[],[]],s=[numeric.rep([1+f],0),[],[]],h=m[0],l=m[1],p=m[2],y=s[0],g=s[1],d=s[2],v=numeric.rep([f],0),x=numeric.rep([f],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),M=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),A=new numeric.ccsDFS(f);for(void 0===n&&(n=1),e=0;e<f;++e){for(b(m,r,v,x,e,k,A),o=u=-1,i=x.length-1;-1!==i;--i)(t=x[i])<=e||u<(c=w(v[t]))&&(o=t,u=c);for(w(v[e])<n*u&&(i=M[e],u=M[o],k[M[e]=u]=e,k[M[o]=i]=o,u=v[e],v[e]=v[o],v[o]=u),u=h[e],o=y[e],a=v[e],l[u]=M[e],p[u]=1,++u,i=x.length-1;-1!==i;--i)c=v[t=x[i]],x[i]=0,v[t]=0,t<=e?(g[o]=t,d[o]=c,++o):(l[u]=M[t],p[u]=c/a,++u);h[e+1]=u,y[e+1]=o}for(i=l.length-1;-1!==i;--i)l[i]=k[l[i]];return{L:m,U:s,P:M,Pinv:k}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,i,t,u,o){var c,a,f,m=0,s=t.length,h=this.k,l=this.k1,p=this.j;if(0===i[r])for(i[r]=1,p[0]=r,h[0]=a=n[u[r]],l[0]=f=n[u[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(f<=a){if(t[s]=u[p[m]],0===m)return;++s,a=h[--m],f=l[m]}else 0===i[c=e[a]]?(i[c]=1,h[m]=a,a=n[c=u[p[++m]=c]],l[m]=f=n[c+1]):++a}},numeric.ccsLPSolve0=function(r,n,e,i,t,u,o,c){var a,f,m,s,h,l,p,y=r[0],g=r[1],d=r[2],v=(y.length,n[0]),x=n[1],b=n[2],w=v[t],M=v[t+1];for(i.length=0,a=w;a<M;++a)c.dfs(x[a],y,g,e,i,u,o);for(a=i.length-1;-1!==a;--a)e[o[f=i[a]]]=0;for(a=w;a!==M;++a)e[f=x[a]]=b[a];for(a=i.length-1;-1!==a;--a){for(l=o[f=i[a]],m=y[f],s=y[f+1],h=m;h<s;++h)if(g[h]===l){e[l]/=d[h];break}for(p=e[l],h=m;h<s;++h)e[g[h]]-=p*d[h];e[l]=p}},numeric.ccsLUP0=function(r,n){var e,i,t,u,o,c,a,f=r[0].length-1,m=[numeric.rep([1+f],0),[],[]],s=[numeric.rep([1+f],0),[],[]],h=m[0],l=m[1],p=m[2],y=s[0],g=s[1],d=s[2],v=numeric.rep([f],0),x=numeric.rep([f],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),M=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),A=new numeric.ccsDFS0(f);for(void 0===n&&(n=1),e=0;e<f;++e){for(b(m,r,v,x,e,k,M,A),o=u=-1,i=x.length-1;-1!==i;--i)(t=x[i])<=e||u<(c=w(v[M[t]]))&&(o=t,u=c);for(w(v[M[e]])<n*u&&(i=M[e],u=M[o],k[M[e]=u]=e,k[M[o]=i]=o),u=h[e],o=y[e],a=v[M[e]],l[u]=M[e],p[u]=1,++u,i=x.length-1;-1!==i;--i)c=v[M[t=x[i]]],x[i]=0,v[M[t]]=0,t<=e?(g[o]=t,d[o]=c,++o):(l[u]=M[t],p[u]=c/a,++u);h[e+1]=u,y[e+1]=o}for(i=l.length-1;-1!==i;--i)l[i]=k[l[i]];return{L:m,U:s,P:M,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var i=numeric.ccsDim(r),t=i[0],u=i[1];void 0===n?n=numeric.linspace(0,t-1):"number"==typeof n&&(n=[n]),void 0===e?e=numeric.linspace(0,u-1):"number"==typeof e&&(e=[e]);for(var o,c,a=n.length,f=e.length,m=numeric.rep([u],0),s=[],h=[],l=[m,s,h],p=r[0],y=r[1],g=r[2],d=numeric.rep([t],0),v=0,x=numeric.rep([t],0),b=0;b<f;++b){for(var w=p[c=e[b]],M=p[c+1],k=w;k<M;++k)x[o=y[k]]=1,d[o]=g[k];for(k=0;k<a;++k)x[n[k]]&&(s[v]=k,h[v]=d[n[k]],++v);for(k=w;k<M;++k)x[o=y[k]]=0;m[b+1]=v}return l},numeric.ccsDot=function(r,n){for(var e,i,t,u,o,c,a,f,m,s,h=r[0],l=r[1],p=r[2],y=n[0],g=n[1],d=n[2],v=numeric.ccsDim(r),x=numeric.ccsDim(n),b=v[0],w=(v[1],x[1]),M=numeric.rep([b],0),k=numeric.rep([b],0),A=Array(b),T=numeric.rep([w],0),j=[],S=[],_=[T,j,S],V=0;V!==w;++V){for(t=y[V],u=y[V+1],f=0,i=t;i<u;++i)for(m=g[i],s=d[i],o=h[m],c=h[m+1],e=o;e<c;++e)0===k[a=l[e]]&&(f+=k[A[f]=a]=1),M[a]=M[a]+p[e]*s;for(u=(t=T[V])+f,T[V+1]=u,i=f-1;-1!==i;--i)s=t+i,e=A[i],j[s]=e,S[s]=M[e],k[e]=0,M[e]=0;T[V+1]=T[V]+f}return _},numeric.ccsLUPSolve=function(r,n){var e=r.L,i=r.U,t=(r.P,n[0]),u=!1;"object"!=typeof t&&(t=(n=[[0,n.length],numeric.linspace(0,n.length-1),n])[0],u=!0);for(var o,c,a,f,m,s=n[1],h=n[2],l=e[0].length-1,p=t.length-1,y=numeric.rep([l],0),g=Array(l),d=numeric.rep([l],0),v=Array(l),x=numeric.rep([1+p],0),b=[],w=[],M=numeric.ccsTSolve,k=0,A=0;A<p;++A){for(f=0,c=t[A],a=t[A+1],o=c;o<a;++o)m=r.Pinv[s[o]],d[v[f]=m]=h[o],++f;for(v.length=f,M(e,d,y,v,g),o=v.length-1;-1!==o;--o)d[v[o]]=0;if(M(i,y,d,g,v),u)return d;for(o=g.length-1;-1!==o;--o)y[g[o]]=0;for(o=v.length-1;-1!==o;--o)m=v[o],b[k]=m,w[k]=d[m],d[m]=0,++k;x[A+1]=k}return[x,b,w]},numeric.ccsbinop=function(r,n){return void 0===n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){for(var n=r[0],e=r[1],i=r[2],t=numeric.sup(e)+1,u=n.length,o=numeric.rep([t],0),c=Array(u),a=Array(u),f=numeric.rep([t],0),m=0;m<u;++m)f[e[m]]++;for(m=0;m<t;++m)o[m+1]=o[m]+f[m];var s,h,l=o.slice(0);for(m=0;m<u;++m)c[s=l[h=e[m]]]=n[m],a[s]=i[m],l[h]=l[h]+1;return[o,c,a]},numeric.ccsGather=function(r){for(var n,e,i,t=r[0],u=r[1],o=r[2],c=t.length-1,a=u.length,f=Array(a),m=Array(a),s=Array(a),h=0,l=0;l<c;++l)for(e=t[l],i=t[l+1],n=e;n!==i;++n)m[h]=l,f[h]=u[n],s[h]=o[n],++h;return[f,m,s]},numeric.sdim=function r(n,e,i){if(void 0===e&&(e=[]),"object"!=typeof n)return e;var t;for(t in void 0===i&&(i=0),i in e||(e[i]=0),n.length>e[i]&&(e[i]=n.length),n)n.hasOwnProperty(t)&&r(n[t],e,i+1);return e},numeric.sclone=function r(n,e,i){void 0===e&&(e=0),void 0===i&&(i=numeric.sdim(n).length);var t,u=Array(n.length);if(e===i-1){for(t in n)n.hasOwnProperty(t)&&(u[t]=n[t]);return u}for(t in n)n.hasOwnProperty(t)&&(u[t]=r(n[t],e+1,i));return u},numeric.sdiag=function(r){for(var n,e=r.length,i=Array(e),t=e-1;1<=t;t-=2)n=t-1,i[t]=[],i[t][t]=r[t],i[n]=[],i[n][n]=r[n];return 0===t&&(i[0]=[],i[0][0]=r[t]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,i,t=[];r.length;for(n in r)if(r.hasOwnProperty(n))for(e in i=r[n])i.hasOwnProperty(e)&&("object"!=typeof t[e]&&(t[e]=[]),t[e][n]=i[e]);return t},numeric.sLUP=function(r,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){for(var e,i,t,u,o,c,a=r.length,f=(n.length,numeric.stranspose(n)),m=f.length,s=Array(a),h=a-1;0<=h;h--){for(c=[],e=r[h],u=m-1;0<=u;u--){for(t in o=0,i=f[u],e)e.hasOwnProperty(t)&&t in i&&(o+=e[t]*i[t]);o&&(c[u]=o)}s[h]=c}return s},numeric.sdotMV=function(r,n){for(var e,i,t,u=r.length,o=Array(u),c=u-1;0<=c;c--){for(i in t=0,e=r[c])e.hasOwnProperty(i)&&n[i]&&(t+=e[i]*n[i]);t&&(o[c]=t)}return o},numeric.sdotVM=function(r,n){var e,i,t,u,o=[];for(e in r)if(r.hasOwnProperty(e))for(i in t=n[e],u=r[e],t)t.hasOwnProperty(i)&&(o[i]||(o[i]=0),o[i]+=u*t[i]);return o},numeric.sdotVV=function(r,n){var e,i=0;for(e in r)r[e]&&n[e]&&(i+=r[e]*n[e]);return i},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,i=numeric.sdim(n).length;switch(1e3*e+i){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+i)}},numeric.sscatter=function(r){for(var n,e,i,t=r[0].length,u=r.length,o=[],c=t-1;0<=c;--c)if(r[u-1][c]){for(i=o,e=0;e<u-2;e++)i[n=r[e][c]]||(i[n]=[]),i=i[n];i[r[e][c]]=r[e+1][c]}return o},numeric.sgather=function r(n,e,i){var t,u,o;for(u in void 0===e&&(e=[]),void 0===i&&(i=[]),t=i.length,n)if(n.hasOwnProperty(u))if(i[t]=parseInt(u),"number"==typeof(o=n[u])){if(o){if(0===e.length)for(u=t+1;0<=u;--u)e[u]=[];for(u=t;0<=u;--u)e[u].push(i[u]);e[t+1].push(o)}}else r(o,e,i);return i.length>t&&i.pop(),e},numeric.cLU=function(r){for(var n,e,i,t,u=r[0],o=r[1],c=r[2],a=u.length,f=0,m=0;m<a;m++)u[m]>f&&(f=u[m]);f++;for(var s,h=Array(f),l=Array(f),p=numeric.rep([f],1/0),y=numeric.rep([f],-1/0),g=0;g<a;g++)m=u[g],(n=o[g])<p[m]&&(p[m]=n),n>y[m]&&(y[m]=n);for(m=0;m<f-1;m++)y[m]>y[m+1]&&(y[m+1]=y[m]);for(m=f-1;1<=m;m--)p[m]<p[m-1]&&(p[m-1]=p[m]);for(m=0;m<f;m++)l[m]=numeric.rep([y[m]-p[m]+1],0),h[m]=numeric.rep([m-p[m]],0),p[m],y[m];for(g=0;g<a;g++)l[m=u[g]][o[g]-p[m]]=c[g];for(m=0;m<f-1;m++)for(e=m-p[m],x=l[m],n=m+1;p[n]<=m&&n<f;n++)if(i=m-p[n],t=y[m]-m,s=(b=l[n])[i]/x[e]){for(g=1;g<=t;g++)b[g+i]-=s*x[g+e];h[n][m-p[n]]=s}var d,v,x=[],b=[],w=[],M=[],k=[],A=[];for(m=d=a=0;m<f;m++){for(e=p[m],i=y[m],v=l[m],n=m;n<=i;n++)v[n-e]&&(x[a]=m,b[a]=n,w[a]=v[n-e],a++);for(v=h[m],n=e;n<m;n++)v[n-e]&&(M[d]=m,k[d]=n,A[d]=v[n-e],d++);M[d]=m,k[d]=m,A[d]=1,d++}return{U:[x,b,w],L:[M,k,A]}},numeric.cLUsolve=function(r,n){for(var e=r.L,i=r.U,t=numeric.clone(n),u=e[0],o=e[1],c=e[2],a=i[0],f=i[1],m=i[2],s=a.length,h=(u.length,t.length),l=0,p=0;p<h;p++){for(;o[l]<p;)t[p]-=c[l]*t[o[l]],l++;l++}for(l=s-1,p=h-1;0<=p;p--){for(;f[l]>p;)t[p]-=m[l]*t[f[l]],l--;t[p]/=m[l],l--}return t},numeric.cgrid=function(e,r){"number"==typeof e&&(e=[e,e]);var n,i,t,u=numeric.rep(e,-1);if("function"!=typeof r)switch(r){case"L":r=function(r,n){return r>=e[0]/2||n<e[1]/2};break;default:r=function(r,n){return!0}}for(t=0,n=1;n<e[0]-1;n++)for(i=1;i<e[1]-1;i++)r(n,i)&&(u[n][i]=t,t++);return u},numeric.cdelsq=function(r){for(var n,e,i,t,u=[[-1,0],[0,-1],[0,1],[1,0]],o=numeric.dim(r),c=o[0],a=o[1],f=[],m=[],s=[],h=1;h<c-1;h++)for(n=1;n<a-1;n++)if(!(r[h][n]<0)){for(e=0;e<4;e++)i=h+u[e][0],t=n+u[e][1],r[i][t]<0||(f.push(r[h][n]),m.push(r[i][t]),s.push(-1));f.push(r[h][n]),m.push(r[h][n]),s.push(4)}return[f,m,s]},numeric.cdotMV=function(r,n){for(var e,i=r[0],t=r[1],u=r[2],o=i.length,c=0,a=0;a<o;a++)i[a]>c&&(c=i[a]);for(c++,e=numeric.rep([c],0),a=0;a<o;a++)e[i[a]]+=u[a]*n[t[a]];return e},numeric.Spline=function(r,n,e,i,t){this.x=r,this.yl=n,this.yr=e,this.kl=i,this.kr=t},numeric.Spline.prototype._at=function(r,n){var e=this.x,i=this.yl,t=this.yr,u=this.kl,o=this.kr,c=numeric.add,a=numeric.sub,f=numeric.mul,m=a(f(u[n],e[n+1]-e[n]),a(t[n+1],i[n])),s=c(f(o[n+1],e[n]-e[n+1]),a(t[n+1],i[n])),h=(r-e[n])/(e[n+1]-e[n]),l=h*(1-h);return c(c(c(f(1-h,i[n]),f(h,t[n+1])),f(m,l*(1-h))),f(s,l*h))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){for(var n,e=this.x,i=e.length,t=Math.floor,u=0,o=i-1;1<o-u;)e[n=t((u+o)/2)]<=r?u=n:o=n;return this._at(r,u)}for(var i=r.length,c=Array(i),a=i-1;-1!==a;--a)c[a]=this.at(r[a]);return c},numeric.Spline.prototype.diff=function(){for(var r,n,e=this.x,i=this.yl,t=this.yr,u=this.kl,o=this.kr,c=i.length,a=u,f=o,m=Array(c),s=Array(c),h=numeric.add,l=numeric.mul,p=numeric.div,y=numeric.sub,g=c-1;-1!==g;--g)r=e[g+1]-e[g],n=y(t[g+1],i[g]),m[g]=p(h(l(n,6),l(u[g],-4*r),l(o[g+1],-2*r)),r*r),s[g+1]=p(h(l(n,-6),l(u[g],2*r),l(o[g+1],4*r)),r*r);return new numeric.Spline(e,a,f,m,s)},numeric.Spline.prototype.roots=function(){var r=[],n=this.x,e=this.yl,i=this.yr,t=this.kl,u=this.kr;"number"==typeof e[0]&&(e=[e],i=[i],t=[t],u=[u]);for(var o,c,a,f,m,s,h,l,p,y,g,d,v,x,b,w,M,k,A,T,j,S,_,V=e.length,P=n.length-1,r=Array(V),q=Math.sqrt,F=0;F!==V;++F){for(a=e[F],f=i[F],m=t[F],s=u[F],h=[],o=0;o!==P;o++){for(0<o&&f[o]*a[o]<0&&h.push(n[o]),b=n[o+1]-n[o],n[o],y=a[o],g=f[o+1],l=m[o]/b,d=(p=s[o+1]/b)+3*y+2*l-3*g,v=3*(p+l+2*(y-g)),(x=(_=l-p+3*(y-g))*_+12*p*y)<=0?w=(M=d/v)>n[o]&&M<n[o+1]?[n[o],M,n[o+1]]:[n[o],n[o+1]]:(M=(d-q(x))/v,k=(d+q(x))/v,w=[n[o]],M>n[o]&&M<n[o+1]&&w.push(M),k>n[o]&&k<n[o+1]&&w.push(k),w.push(n[o+1])),T=w[0],M=this._at(T,o),c=0;c<w.length-1;c++)if(j=w[c+1],k=this._at(j,o),0!==M)if(0===k||0<M*k)T=j,M=k;else{for(var L=0;!((S=(M*j-k*T)/(M-k))<=T||j<=S);)if(0<(A=this._at(S,o))*k)j=S,k=A,-1===L&&(M*=.5),L=-1;else{if(!(0<A*M))break;T=S,M=A,1===L&&(k*=.5),L=1}h.push(S),T=w[c+1],M=this._at(T,o)}else h.push(T),T=j,M=k;0===k&&h.push(j)}r[F]=h}return"number"==typeof this.yl[0]?r[0]:r},numeric.spline=function(r,n,e,i){for(var t=r.length,u=[],o=[],c=[],a=numeric.sub,f=numeric.mul,m=numeric.add,s=t-2;0<=s;s--)o[s]=r[s+1]-r[s],c[s]=a(n[s+1],n[s]);"string"!=typeof e&&"string"!=typeof i||(e=i="periodic");var h=[[],[],[]];switch(typeof e){case"undefined":u[0]=f(3/(o[0]*o[0]),c[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/o[0],1/o[0]);break;case"string":u[0]=m(f(3/(o[t-2]*o[t-2]),c[t-2]),f(3/(o[0]*o[0]),c[0])),h[0].push(0,0,0),h[1].push(t-2,0,1),h[2].push(1/o[t-2],2/o[t-2]+2/o[0],1/o[0]);break;default:u[0]=e,h[0].push(0),h[1].push(0),h[2].push(1)}for(s=1;s<t-1;s++)u[s]=m(f(3/(o[s-1]*o[s-1]),c[s-1]),f(3/(o[s]*o[s]),c[s])),h[0].push(s,s,s),h[1].push(s-1,s,s+1),h[2].push(1/o[s-1],2/o[s-1]+2/o[s],1/o[s]);switch(typeof i){case"undefined":u[t-1]=f(3/(o[t-2]*o[t-2]),c[t-2]),h[0].push(t-1,t-1),h[1].push(t-2,t-1),h[2].push(1/o[t-2],2/o[t-2]);break;case"string":h[1][h[1].length-1]=0;break;default:u[t-1]=i,h[0].push(t-1),h[1].push(t-1),h[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var l=Array(u.length);if("string"==typeof e)for(s=l.length-1;-1!==s;--s)l[s]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),u[s]),l[s][t-1]=l[s][0];else for(s=l.length-1;-1!==s;--s)l[s]=numeric.cLUsolve(numeric.cLU(h),u[s]);return l="number"==typeof n[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,n,n,l,l)},numeric.fftpow2=function r(n,e){var i=n.length;if(1!==i){for(var t=Math.cos,u=Math.sin,o=Array(i/2),c=Array(i/2),a=Array(i/2),f=Array(i/2),m=i/2,s=i-1;-1!==s;--s)a[--m]=n[s],f[m]=e[s],--s,o[m]=n[s],c[m]=e[s];r(o,c),r(a,f),m=i/2;var h,l,p,y=-6.283185307179586/i;for(s=i-1;-1!==s;--s)-1===--m&&(m=i/2-1),l=t(h=y*s),p=u(h),n[s]=o[m]+l*a[m]-p*f[m],e[s]=c[m]+l*f[m]+p*a[m]}},numeric._ifftpow2=function r(n,e){var i=n.length;if(1!==i){for(var t=Math.cos,u=Math.sin,o=Array(i/2),c=Array(i/2),a=Array(i/2),f=Array(i/2),m=i/2,s=i-1;-1!==s;--s)a[--m]=n[s],f[m]=e[s],--s,o[m]=n[s],c[m]=e[s];r(o,c),r(a,f),m=i/2;var h,l,p,y=6.283185307179586/i;for(s=i-1;-1!==s;--s)-1===--m&&(m=i/2-1),l=t(h=y*s),p=u(h),n[s]=o[m]+l*a[m]-p*f[m],e[s]=c[m]+l*f[m]+p*a[m]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,i){numeric.fftpow2(r,n),numeric.fftpow2(e,i);for(var t,u,o,c,a=r.length-1;-1!==a;--a)t=r[a],o=n[a],u=e[a],c=i[a],r[a]=t*u-o*c,n[a]=t*c+o*u;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){for(var r,n=this.x,e=this.y,i=n.length,t=Math.log,u=t(2),o=Math.ceil(t(2*i-1)/u),c=Math.pow(2,o),a=numeric.rep([c],0),f=numeric.rep([c],0),m=Math.cos,s=Math.sin,h=-3.141592653589793/i,l=numeric.rep([c],0),p=numeric.rep([c],0),y=(Math.floor(i/2),0);y<i;y++)l[y]=n[y];if(void 0!==e)for(y=0;y<i;y++)p[y]=e[y];for(y=a[0]=1;y<=c/2;y++)r=h*y*y,a[y]=m(r),f[y]=s(r),a[c-y]=m(r),f[c-y]=s(r);var g=new numeric.T(l,p),d=new numeric.T(a,f),g=g.mul(d);return numeric.convpow2(g.x,g.y,numeric.clone(d.x),numeric.neg(d.y)),(g=g.mul(d)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){for(var r,n=this.x,e=this.y,i=n.length,t=Math.log,u=t(2),o=Math.ceil(t(2*i-1)/u),c=Math.pow(2,o),a=numeric.rep([c],0),f=numeric.rep([c],0),m=Math.cos,s=Math.sin,h=3.141592653589793/i,l=numeric.rep([c],0),p=numeric.rep([c],0),y=(Math.floor(i/2),0);y<i;y++)l[y]=n[y];if(void 0!==e)for(y=0;y<i;y++)p[y]=e[y];for(y=a[0]=1;y<=c/2;y++)r=h*y*y,a[y]=m(r),f[y]=s(r),a[c-y]=m(r),f[c-y]=s(r);var g=new numeric.T(l,p),d=new numeric.T(a,f),g=g.mul(d);return numeric.convpow2(g.x,g.y,numeric.clone(d.x),numeric.neg(d.y)),(g=g.mul(d)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(r,n){var e=n.length,i=r(n);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");for(var t,u,o,c,a,f,m,s,h=Math.max,l=numeric.clone(n),p=Array(e),h=(numeric.div,numeric.sub,Math.max),y=Math.abs,g=Math.min,d=0,v=0;v<e;v++)for(var x=h(1e-6*i,1e-8);;){if(20<++d)throw new Error("Numerical gradient fails");if(l[v]=n[v]+x,t=r(l),l[v]=n[v]-x,u=r(l),l[v]=n[v],isNaN(t)||isNaN(u))x/=16;else{if(p[v]=(t-u)/(2*x),o=n[v]-x,c=n[v],a=n[v]+x,f=(t-i)/x,m=(i-u)/x,s=h(y(p[v]),y(i),y(t),y(u),y(o),y(c),y(a),1e-8),!(.001<g(h(y(f-p[v]),y(m-p[v]),y(f-m))/s,x/s)))break;x/=16}}return p},numeric.uncmin=function(n,r,e,i,t,u,o){var c=numeric.gradient;void 0===o&&(o={}),void 0===e&&(e=1e-8),void 0===i&&(i=function(r){return c(n,r)}),void 0===t&&(t=1e3);var a,f,m=(r=numeric.clone(r)).length,s=n(r);if(isNaN(s))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,l=numeric.norm2;e=h(e,numeric.epsilon);for(var p,y,g,d,v,x,b,w,M,k=o.Hinv||numeric.identity(m),A=numeric.dot,T=(numeric.inv,numeric.sub),j=numeric.add,S=numeric.tensor,_=numeric.div,V=numeric.mul,P=numeric.all,q=numeric.isFinite,F=numeric.neg,L=0,N="",O=i(r);L<t;){if("function"==typeof u&&u(L,r,s,O,k)){N="Callback returned true";break}if(!P(q(O))){N="Gradient has Infinity or NaN";break}if(!P(q(p=F(A(k,O))))){N="Search direction has Infinity or NaN";break}if((M=l(p))<e){N="Newton step smaller than tol";break}for(w=1,f=A(O,p),d=r;L<t&&!(w*M<e)&&(d=j(r,g=V(p,w)),.1*w*f<=(a=n(d))-s||isNaN(a));)w*=.5,++L;if(w*M<e){N="Line search step size smaller than tol";break}if(L===t){N="maxit reached during line search";break}b=A(v=T(y=i(d),O),g),x=A(k,v),k=T(j(k,V((b+A(v,x))/(b*b),S(g,g))),_(j(S(x,g),S(g,x)),b)),r=d,s=a,O=y,++L}return{solution:r,f:s,gradient:O,invHessian:k,iterations:L,message:N}},numeric.Dopri=function(r,n,e,i,t,u,o){this.x=r,this.y=n,this.f=e,this.ymid=i,this.iterations=t,this.events=o,this.message=u},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var i=this.x,t=this.y,u=this.f,o=this.ymid,c=(i.length,Math.floor,numeric.add),a=numeric.mul,f=numeric.sub,m=i[n],s=i[n+1],h=t[n],l=t[n+1],p=m+.5*(s-m),y=o[n],g=f(u[n],a(h,1/(m-p)+2/(m-s))),d=f(u[n+1],a(l,1/(s-p)+2/(s-m))),v=[e(r-s)*(r-p)/e(m-s)/(m-p),e(r-m)*e(r-s)/e(m-p)/e(s-p),e(r-m)*(r-p)/e(s-m)/(s-p),(r-m)*e(r-s)*(r-p)/e(m-s)/(m-p),(r-s)*e(r-m)*(r-p)/e(m-s)/(s-p)];return c(c(c(c(a(h,v[0]),a(y,v[1])),a(l,v[2])),a(g,v[3])),a(d,v[4]))},numeric.Dopri.prototype.at=function(r){var n,e,i=Math.floor;if("number"!=typeof r){for(var t=r.length,u=Array(t),o=t-1;-1!==o;--o)u[o]=this.at(r[o]);return u}var c=this.x;for(o=0,n=c.length-1;1<n-o;)c[e=i(.5*(o+n))]<=r?o=e:n=e;return this._at(r,o)},numeric.dopri=function(r,n,e,i,t,u,o){void 0===t&&(t=1e-6),void 0===u&&(u=1e3);var c,a,f,m,s,h,l,p,y,g,d,v=[r],x=[e],b=[i(r,e)],w=[],M=[.075,.225],k=[44/45,-56/15,32/9],A=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],j=[35/384,0,500/1113,125/192,-2187/6784,11/84],S=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],_=[.2,.3,.8,8/9,1,1],V=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],P=0,q=(n-r)/10,F=0,L=numeric.add,N=numeric.mul,O=(Math.max,Math.min),U=Math.abs,D=numeric.norminf,B=Math.pow,X=numeric.any,R=numeric.lt,E=numeric.and,Y=(numeric.sub,new numeric.Dopri(v,x,b,w,-1,""));for("function"==typeof o&&(d=o(r,e));r<n&&F<u;){if(++F,n<r+q&&(q=n-r),c=i(r+_[0]*q,L(e,N(.2*q,b[P]))),a=i(r+_[1]*q,L(L(e,N(M[0]*q,b[P])),N(M[1]*q,c))),f=i(r+_[2]*q,L(L(L(e,N(k[0]*q,b[P])),N(k[1]*q,c)),N(k[2]*q,a))),m=i(r+_[3]*q,L(L(L(L(e,N(A[0]*q,b[P])),N(A[1]*q,c)),N(A[2]*q,a)),N(A[3]*q,f))),s=i(r+_[4]*q,L(L(L(L(L(e,N(T[0]*q,b[P])),N(T[1]*q,c)),N(T[2]*q,a)),N(T[3]*q,f)),N(T[4]*q,m))),h=i(r+q,y=L(L(L(L(L(e,N(b[P],q*j[0])),N(a,q*j[2])),N(f,q*j[3])),N(m,q*j[4])),N(s,q*j[5]))),t<(g=("number"==typeof(l=L(L(L(L(L(N(b[P],q*V[0]),N(a,q*V[2])),N(f,q*V[3])),N(m,q*V[4])),N(s,q*V[5])),N(h,q*V[6])))?U:D)(l))){if(r+(q=.2*q*B(t/g,.25))!==r)continue;Y.msg="Step size became too small";break}if(w[P]=L(L(L(L(L(L(e,N(b[P],q*S[0])),N(a,q*S[2])),N(f,q*S[3])),N(m,q*S[4])),N(s,q*S[5])),N(h,q*S[6])),v[++P]=r+q,x[P]=y,b[P]=h,"function"==typeof o){var I,Q,C,Z=r,H=r+.5*q,z=o(H,w[P-1]);if(X(C=E(R(d,0),R(0,z)))||(Z=H,d=z,z=o(H=r+q,y),C=E(R(d,0),R(0,z))),X(C)){for(var G,$,W=0,J=1,K=1;;){if("number"==typeof d)Q=(K*z*Z-J*d*H)/(K*z-J*d);else for(Q=H,p=d.length-1;-1!==p;--p)d[p]<0&&0<z[p]&&(Q=O(Q,(K*z[p]*Z-J*d[p]*H)/(K*z[p]-J*d[p])));if(Q<=Z||H<=Q)break;$=o(Q,I=Y._at(Q,P-1)),W=X(G=E(R(d,0),R(0,$)))?(H=Q,z=$,C=G,-(K=1)===W?J*=.5:J=1,-1):(Z=Q,d=$,(J=1)===W?K*=.5:K=1,1)}return y=Y._at(.5*(r+Q),P-1),Y.f[P]=i(Q,I),Y.x[P]=Q,Y.y[P]=I,Y.ymid[P-1]=y,Y.events=C,Y.iterations=F,Y}}r+=q,e=y,d=z,q=O(.8*q*B(t/g,.25),4*q)}return Y.iterations=F,Y},numeric.LU=function(r,n){n=n||!1;var e,i,t,u,o,c,a,f,m,s=Math.abs,h=r.length,l=h-1,p=new Array(h);for(n||(r=numeric.clone(r)),t=0;t<h;++t){for(m=s((c=r[a=t])[t]),i=t+1;i<h;++i)m<(u=s(r[i][t]))&&(m=u,a=i);for((p[t]=a)!=t&&(r[t]=r[a],r[a]=c,c=r[t]),o=c[t],e=t+1;e<h;++e)r[e][t]/=o;for(e=t+1;e<h;++e){for(f=r[e],i=t+1;i<l;++i)f[i]-=f[t]*c[i],f[++i]-=f[t]*c[i];i===l&&(f[i]-=f[t]*c[i])}}return{LU:r,P:p}},numeric.LUsolve=function(r,n){for(var e,i,t,u,o=r.LU,c=o.length,a=numeric.clone(n),f=r.P,m=c-1;-1!==m;--m)a[m]=n[m];for(m=0;m<c;++m)for(i=f[m],f[m]!==m&&(u=a[m],a[m]=a[i],a[i]=u),t=o[m],e=0;e<m;++e)a[m]-=a[e]*t[e];for(m=c-1;0<=m;--m){for(t=o[m],e=m+1;e<c;++e)a[m]-=a[e]*t[e];a[m]/=t[m]}return a},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,i,t,u,o,c,a,f=numeric.dim(r),m=f[0],s=f[1],h=numeric.identity(m),l=Array(m),p=Math.abs,y=numeric.diveq;for(r=numeric.clone(r),n=0;n<m;++n){for(i=0,u=r[n],o=h[n],e=1;e<s;++e)p(u[i])<p(u[e])&&(i=e);for(y(o,u[l[n]=i]),y(u,u[i]),e=0;e<m;++e)if(e!==n){for(a=(c=r[e])[i],t=s-1;-1!==t;--t)c[t]-=u[t]*a;for(c=h[e],t=m-1;-1!==t;--t)c[t]-=o[t]*a}}return{I:h,A:r,P:l}},numeric.__solveLP=function(r,n,e,i,t,u,o){for(var c,a,f,m,s=numeric.sum,h=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,y=numeric.div,g=numeric.add,d=r.length,v=e.length,x=!1,b=1,w=(numeric.transpose(n),numeric.svd,numeric.transpose),M=(numeric.leq,Math.sqrt),k=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,j=numeric.gt,S=Array(d),_=Array(v),V=(numeric.rep([v],1),numeric.solve),P=l(e,p(n,u)),q=p(r,r),F=0;F<t;++F){for(X=v-1;-1!==X;--X)_[X]=y(n[X],P[X]);var L=w(_);for(X=d-1;-1!==X;--X)S[X]=s(L[X]);b=.25*k(q/p(r,S));var N=100*M(q/p(S,S));for((!isFinite(b)||N<b)&&(b=N),f=g(r,h(b,S)),a=p(L,_),X=d-1;-1!==X;--X)a[X][X]+=1;m=V(a,y(f,b),!0);var O=y(P,p(n,m)),U=1;for(X=v-1;-1!==X;--X)O[X]<0&&(U=A(U,-.999*O[X]));if(c=l(u,h(m,U)),!T(j(P=l(e,p(n,c)),0)))return{solution:u,message:"",iterations:F};if(u=c,b<i)return{solution:c,message:"",iterations:F};if(o){for(var D=p(r,f),B=p(n,f),x=!0,X=v-1;-1!==X;--X)if(D*B[X]<0){x=!1;break}}else x=!(0<=u[d-1]);if(x)return{solution:c,message:"Unbounded",iterations:F}}return{solution:u,message:"maximum iteration count exceeded",iterations:F}},numeric._solveLP=function(r,n,e,i,t){var u=r.length,o=e.length,c=(numeric.sum,numeric.log,numeric.mul,numeric.sub),a=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([u],0).concat([1])),m=numeric.rep([o,1],-1),s=numeric.blockMatrix([[n,m]]),h=e,l=numeric.rep([u],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),p=numeric.__solveLP(f,s,h,i,t,l,!1),y=numeric.clone(p.solution);if(y.length=u,numeric.inf(c(e,a(n,y)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(r,n,e,i,t-p.iterations,y,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(r,n,e,i,t,u,o){if(void 0===o&&(o=1e3),void 0===u&&(u=numeric.epsilon),void 0===i)return numeric._solveLP(r,n,e,u,o);for(var c=i.length,a=i[0].length,f=n.length,m=numeric.echelonize(i),s=numeric.rep([a],0),h=m.P,l=[],p=h.length-1;-1!==p;--p)s[h[p]]=1;for(p=a-1;-1!==p;--p)0===s[p]&&l.push(p);var y=numeric.getRange,g=numeric.linspace(0,c-1),d=numeric.linspace(0,f-1),v=y(i,g,l),x=y(n,d,h),b=y(n,d,l),w=numeric.dot,M=numeric.sub,k=w(x,m.I),A=M(b,w(k,v)),T=M(e,w(k,t)),j=Array(h.length),S=Array(l.length);for(p=h.length-1;-1!==p;--p)j[p]=r[h[p]];for(p=l.length-1;-1!==p;--p)S[p]=r[l[p]];var _=M(S,w(j,w(m.I,v))),V=numeric._solveLP(_,A,T,u,o),P=V.solution;if(P!=P)return V;var q=w(m.I,M(t,w(v,P))),F=Array(r.length);for(p=h.length-1;-1!==p;--p)F[h[p]]=q[p];for(p=l.length-1;-1!==p;--p)F[l[p]]=P[p];return{solution:F,message:V.message,iterations:V.iterations}},numeric.MPStoLP=function(n){function r(r){throw new Error("MPStoLP: "+r+"\nLine "+g+": "+n[g]+"\nCurrent state: "+u[t]+"\n")}n instanceof String&&n.split("\n");for(var e,i,t=0,u=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],o=n.length,c=0,a={},f=[],m=0,s={},h=0,l=[],p=[],y=[],g=0;g<o;++g){var d=(e=n[g]).match(/\S*/g),v=[];for(w=0;w<d.length;++w)""!==d[w]&&v.push(d[w]);if(0!==v.length){for(w=0;w<u.length&&e.substr(0,u[w].length)!==u[w];++w);if(w<u.length){if(1===(t=w)&&(i=v[1]),6===w)return{name:i,c:l,A:numeric.transpose(p),b:y,rows:a,vars:s}}else switch(t){case 0:case 1:r("Unexpected line");case 2:switch(v[0]){case"N":0===c?c=v[1]:r("Two or more N rows");break;case"L":f[a[v[1]]=m]=1,y[m]=0,++m;break;case"G":f[a[v[1]]=m]=-1,y[m]=0,++m;break;case"E":f[a[v[1]]=m]=0,y[m]=0,++m;break;default:r("Parse error "+numeric.prettyPrint(v))}break;case 3:s.hasOwnProperty(v[0])||(l[s[v[0]]=h]=0,p[h]=numeric.rep([m],0),++h);for(var x,b=s[v[0]],w=1;w<v.length;w+=2){v[w]!==c?(x=a[v[w]],p[b][x]=(f[x]<0?-1:1)*parseFloat(v[w+1])):l[b]=parseFloat(v[w+1])}break;case 4:for(w=1;w<v.length;w+=2)y[a[v[w]]]=(f[a[v[w]]]<0?-1:1)*parseFloat(v[w+1]);break;case 5:break;case 6:r("Internal error")}}}r("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,u,a,o,c,f){function m(r){var n,e,c=this,i=r.length,t=0,u=c.i=c.j=c.m=0;for(c.S=[],c.c=[],i||(r=[i++]);t<a;)c.S[t]=t++;for(t=0;t<a;t++)u=h(u+(n=c.S[t])+r[t%i]),e=c.S[u],c.S[t]=e,c.S[u]=n;c.g=function(r){var n=c.S,e=h(c.i+1),i=n[e],t=h(c.j+i),u=n[t];n[e]=u,n[t]=i;for(var o=n[h(i+u)];--r;)e=h(e+1),u=n[t=h(t+(i=n[e]))],n[e]=u,n[t]=i,o=o*a+n[h(i+u)];return c.i=e,c.j=t,o},c.g(a)}function s(r,n,e,i){for(r+="",i=e=0;i<r.length;i++)n[h(i)]=h((e^=19*n[h(i)])+r.charCodeAt(i));for(i in r="",n)r+=String.fromCharCode(n[i]);return r}function h(r){return r&a-1}u.seedrandom=function(r,n){var i,e=[];return r=s(function r(n,e,i,t,u){if(i=[],u=typeof n,e&&"object"==u)for(t in n)if(t.indexOf("S")<5)try{i.push(r(n[t],e-1))}catch(r){}return i.length?i:n+("string"!=u?"\0":"")}(n?[r,t]:arguments.length?r:[(new Date).getTime(),t,window],3),e),s((i=new m(e)).S,t),u.random=function(){for(var r=i.g(6),n=f,e=0;r<o;)r=(r+e)*a,n*=a,e=i.g(1);for(;c<=r;)r/=2,n/=2,e>>>=1;return(r+e)/n},r},f=u.pow(a,6),o=u.pow(2,o),c=2*o,s(u.random(),t)}([],numeric.seedrandom,256,52),function(){function g(r){if("object"!=typeof r)return r;for(var n=[],e=r.length,i=0;i<e;i++)n[i+1]=g(r[i]);return n}function d(r){if("object"!=typeof r)return r;for(var n=[],e=r.length,i=1;i<e;i++)n[i-1]=d(r[i]);return n}function v(r,n,e,i,t,u,o,c,a,f,m,s,h,l,p,y){function g(){for(l[1]=l[1]+1,Q=V,w=1;w<=f;w+=1){for(Q+=1,N=-c[w],M=1;M<=i;M+=1)N+=o[M][w]*t[M];if(Math.abs(N)<C&&(N=0),m<w)p[Q]=N;else if(p[Q]=-Math.abs(N),0<N){for(M=1;M<=i;M+=1)o[M][w]=-o[M][w];c[w]=-c[w]}}for(w=1;w<=h;w+=1)p[V+s[w]]=0;for(L=q=0,w=1;w<=f;w+=1)p[V+w]<L*p[F+w]&&(L=p[V+(q=w)]/p[F+w]);return 0===q?999:0}function d(){for(w=1;w<=i;w+=1){for(N=0,M=1;M<=i;M+=1)N+=r[M][w]*o[M][q];p[w]=N}for(k=j,w=1;w<=i;w+=1)p[k+w]=0;for(M=h+1;M<=i;M+=1)for(w=1;w<=i;w+=1)p[k+w]=p[k+w]+r[w][M]*p[M];for(R=!0,w=h;1<=w;--w){for(N=p[w],k=(Q=_+w*(w+3)/2)-w,M=w+1;M<=h;M+=1)N-=p[Q]*p[S+M],Q+=M;if(N/=p[k],p[S+w]=N,s[w]<m)break;if(N<0)break;R=!1,T=w}if(!R)for(O=p[P+T]/p[S+T],w=1;w<=h&&!(s[w]<m)&&!(p[S+w]<0);w+=1)(L=p[P+w]/p[S+w])<O&&(O=L,T=w);for(N=0,w=j+1;w<=j+i;w+=1)N+=p[w]*p[w];if(Math.abs(N)<=C){if(R)return y[1]=1,999;for(w=1;w<=h;w+=1)p[P+w]=p[P+w]-O*p[S+w];return p[P+h+1]=p[P+h+1]+O,700}for(N=0,w=1;w<=i;w+=1)N+=p[j+w]*o[w][q];for(U=-p[V+q]/N,E=!0,R||O<U&&(U=O,E=!1),w=1;w<=i;w+=1)t[w]=t[w]+U*p[j+w],Math.abs(t[w])<C&&(t[w]=0);for(u[1]=u[1]+U*N*(U/2+p[P+h+1]),w=1;w<=h;w+=1)p[P+w]=p[P+w]-U*p[S+w];if(p[P+h+1]=p[P+h+1]+U,!E){for(N=-c[q],M=1;M<=i;M+=1)N+=t[M]*o[M][q];if(m<q)p[V+q]=N;else if(p[V+q]=-Math.abs(N),0<N){for(M=1;M<=i;M+=1)o[M][q]=-o[M][q];c[q]=-c[q]}return 700}for(s[h+=1]=q,Q=_+(h-1)*h/2+1,w=1;w<=h-1;w+=1)p[Q]=p[w],Q+=1;if(h===i)p[Q]=p[i];else{for(w=i;h+1<=w&&0!==p[w]&&(D=Math.max(Math.abs(p[w-1]),Math.abs(p[w])),B=Math.min(Math.abs(p[w-1]),Math.abs(p[w])),L=0<=p[w-1]?Math.abs(D*Math.sqrt(1+B*B/(D*D))):-Math.abs(D*Math.sqrt(1+B*B/(D*D))),D=p[w-1]/L,B=p[w]/L,1!==D);--w)if(0===D)for(p[w-1]=B*L,M=1;M<=i;M+=1)L=r[M][w-1],r[M][w-1]=r[M][w],r[M][w]=L;else for(p[w-1]=L,X=B/(1+D),M=1;M<=i;M+=1)L=D*r[M][w-1]+B*r[M][w],r[M][w]=X*(r[M][w-1]+L)-r[M][w],r[M][w-1]=L;p[Q]=p[h]}return 0}function v(){if(0===p[k=(Q=_+T*(T+1)/2+1)+T])return 1;if(D=Math.max(Math.abs(p[k-1]),Math.abs(p[k])),B=Math.min(Math.abs(p[k-1]),Math.abs(p[k])),L=0<=p[k-1]?Math.abs(D*Math.sqrt(1+B*B/(D*D))):-Math.abs(D*Math.sqrt(1+B*B/(D*D))),D=p[k-1]/L,B=p[k]/L,1===D)return 1;if(0===D){for(w=T+1;w<=h;w+=1)L=p[k-1],p[k-1]=p[k],p[k]=L,k+=w;for(w=1;w<=i;w+=1)L=r[w][T],r[w][T]=r[w][T+1],r[w][T+1]=L}else{for(X=B/(1+D),w=T+1;w<=h;w+=1)L=D*p[k-1]+B*p[k],p[k]=X*(p[k-1]+L)-p[k],p[k-1]=L,k+=w;for(w=1;w<=i;w+=1)L=D*r[w][T]+B*r[w][T+1],r[w][T+1]=X*(r[w][T]+L)-r[w][T+1],r[w][T]=L}}function x(){for(k=Q-T,w=1;w<=T;w+=1)p[k]=p[Q],Q+=1,k+=1;return p[P+T]=p[P+T+1],s[T]=s[T+1],(T+=1)<h?797:0}function b(){return p[P+h]=p[P+h+1],p[P+h+1]=0,s[h]=0,--h,l[2]=l[2]+1,0}for(var w,M,k,A,T,j,S,_,V,P,q,F,L,N,O,U,D,B,X,R,E,Y,I=Math.min(i,f),Q=2*i+I*(I+5)/2+2*f+1,C=1e-60;1+.1*(C+=C)<=1||1+.2*C<=1;);for(w=1;w<=i;w+=1)p[w]=n[w];for(w=i+1;w<=Q;w+=1)p[w]=0;for(w=1;w<=f;w+=1)s[w]=0;if(A=[],0===y[1]){if(!function(r,n,e){for(var i,t,u,o,c,a=1;a<=n;a+=1){if(c=0,(t=(e[1]=a)-1)<1){if((c=r[a][a]-c)<=0)break;r[a][a]=Math.sqrt(c)}else{for(u=1;u<=t;u+=1){for(o=r[u][a],i=1;i<u;i+=1)o-=r[i][a]*r[i][u];o/=r[u][u],c+=(r[u][a]=o)*o}if((c=r[a][a]-c)<=0)break;r[a][a]=Math.sqrt(c)}e[1]=0}}(r,i,A),0!==A[1])return void(y[1]=2);(function(r,n,e){for(var i,t,u,o=1;o<=n;o+=1){for(u=0,i=1;i<o;i+=1)u+=r[i][o]*e[i];e[o]=(e[o]-u)/r[o][o]}for(t=1;t<=n;t+=1)for(e[o=n+1-t]=e[o]/r[o][o],u=-e[o],i=1;i<o;i+=1)e[i]=e[i]+u*r[i][o]})(r,i,n),function(r,n){for(var e,i,t,u,o=1;o<=n;o+=1){for(r[o][o]=1/r[o][o],u=-r[o][o],e=1;e<o;e+=1)r[e][o]=u*r[e][o];if(n<(t=o+1))break;for(i=t;i<=n;i+=1)for(u=r[o][i],r[o][i]=0,e=1;e<=o;e+=1)r[e][i]=r[e][i]+u*r[e][o]}}(r,i)}else{for(M=1;M<=i;M+=1)for(t[M]=0,w=1;w<=M;w+=1)t[M]=t[M]+r[w][M]*n[w];for(M=1;M<=i;M+=1)for(n[M]=0,w=M;w<=i;w+=1)n[M]=n[M]+r[M][w]*t[w]}for(u[1]=0,M=1;M<=i;M+=1)for(t[M]=n[M],u[1]=u[1]+p[M]*t[M],p[M]=0,w=M+1;w<=i;w+=1)r[w][M]=0;for(u[1]=-u[1]/2,y[1]=0,F=(V=(_=(P=(S=(j=i)+i)+I)+I+1)+I*(I+1)/2)+f,w=1;w<=f;w+=1){for(N=0,M=1;M<=i;M+=1)N+=o[M][w]*o[M][w];p[F+w]=Math.sqrt(N)}for(h=0,l[1]=0,Y=l[2]=0;;){if(999===(Y=g()))return;for(;0!==(Y=d());){if(999===Y)return;if(700===Y)if(T===h)b();else{for(;v(),797===(Y=x()););b()}}}}numeric.solveQP=function(r,n,e,i,t,u){r=g(r),n=g(n),e=g(e);var o,c,a,f,m,s=[],h=[],l=[],p=[],y=[];if(t=t||0,u=u?g(u):[void 0,0],i=i?g(i):[],c=r.length-1,a=e[1].length-1,!i)for(o=1;o<=a;o+=1)i[o]=0;for(o=1;o<=a;o+=1)h[o]=0;for(f=Math.min(c,a),o=1;o<=c;o+=1)l[o]=0;for(s[1]=0,o=1;o<=2*c+f*(f+5)/2+2*a+1;o+=1)p[o]=0;for(o=1;o<=2;o+=1)y[o]=0;return v(r,n,0,c,l,s,e,i,0,a,t,h,0,y,p,u),m="",1===u[1]&&(m="constraints are inconsistent, no solution!"),2===u[1]&&(m="matrix D in quadratic function is not positive definite!"),{solution:d(l),value:d(s),unconstrained_solution:d(n),iterations:d(y),iact:d(h),message:m}}}(),numeric.svd=function(r){function n(r,n){return r=Math.abs(r),(n=Math.abs(n))<r?r*Math.sqrt(1+n*n/r/r):0==n?r:n*Math.sqrt(1+r*r/n/n)}var e,i=numeric.epsilon,t=1e-64/i,u=0,o=0,c=0,a=0,f=0,m=numeric.clone(r),s=m.length,h=m[0].length;if(s<h)throw"Need more rows than columns";var l=new Array(h),p=new Array(h);for(o=0;o<h;o++)l[o]=p[o]=0;var y=numeric.rep([h,h],0),g=0,d=0,v=0,x=0,b=0,w=0,M=0;for(o=0;o<h;o++){for(l[o]=d,M=0,f=o+1,c=o;c<s;c++)M+=m[c][o]*m[c][o];if(M<=t)d=0;else for(g=m[o][o],d=Math.sqrt(M),0<=g&&(d=-d),v=g*d-M,m[o][o]=g-d,c=f;c<h;c++){for(M=0,a=o;a<s;a++)M+=m[a][o]*m[a][c];for(g=M/v,a=o;a<s;a++)m[a][c]+=g*m[a][o]}for(p[o]=d,M=0,c=f;c<h;c++)M+=m[o][c]*m[o][c];if(M<=t)d=0;else{for(g=m[o][o+1],d=Math.sqrt(M),0<=g&&(d=-d),v=g*d-M,m[o][o+1]=g-d,c=f;c<h;c++)l[c]=m[o][c]/v;for(c=f;c<s;c++){for(M=0,a=f;a<h;a++)M+=m[c][a]*m[o][a];for(a=f;a<h;a++)m[c][a]+=M*l[a]}}x<(b=Math.abs(p[o])+Math.abs(l[o]))&&(x=b)}for(o=h-1;-1!=o;o+=-1){if(0!=d){for(v=d*m[o][o+1],c=f;c<h;c++)y[c][o]=m[o][c]/v;for(c=f;c<h;c++){for(M=0,a=f;a<h;a++)M+=m[o][a]*y[a][c];for(a=f;a<h;a++)y[a][c]+=M*y[a][o]}}for(c=f;c<h;c++)y[o][c]=0,y[c][o]=0;y[o][o]=1,d=l[o],f=o}for(o=h-1;-1!=o;o+=-1){for(f=o+1,d=p[o],c=f;c<h;c++)m[o][c]=0;if(0!=d){for(v=m[o][o]*d,c=f;c<h;c++){for(M=0,a=f;a<s;a++)M+=m[a][o]*m[a][c];for(g=M/v,a=o;a<s;a++)m[a][c]+=g*m[a][o]}for(c=o;c<s;c++)m[c][o]=m[c][o]/d}else for(c=o;c<s;c++)m[c][o]=0;m[o][o]+=1}for(i*=x,a=h-1;-1!=a;a+=-1)for(var k=0;k<50;k++){for(var A=!1,f=a;-1!=f;f+=-1){if(Math.abs(l[f])<=i){A=!0;break}if(Math.abs(p[f-1])<=i)break}if(!A){u=0;for(var T=f-(M=1),o=f;o<a+1&&(g=M*l[o],l[o]=u*l[o],!(Math.abs(g)<=i));o++)for(v=n(g,d=p[o]),u=d/(p[o]=v),M=-g/v,c=0;c<s;c++)b=m[c][T],w=m[c][o],m[c][T]=b*u+w*M,m[c][o]=-b*M+w*u}if(w=p[a],f==a){if(w<0)for(p[a]=-w,c=0;c<h;c++)y[c][a]=-y[c][a];break}if(49<=k)throw"Error: no convergence.";for(x=p[f],d=n(g=(((b=p[a-1])-w)*(b+w)+((d=l[a-1])-(v=l[a]))*(d+v))/(2*v*b),1),g=g<0?((x-w)*(x+w)+v*(b/(g-d)-v))/x:((x-w)*(x+w)+v*(b/(g+d)-v))/x,o=f+(M=u=1);o<a+1;o++){for(d=l[o],b=p[o],v=M*d,d*=u,w=n(g,v),g=x*(u=g/(l[o-1]=w))+d*(M=v/w),d=-x*M+d*u,v=b*M,b*=u,c=0;c<h;c++)x=y[c][o-1],w=y[c][o],y[c][o-1]=x*u+w*M,y[c][o]=-x*M+w*u;for(w=n(g,v),g=(u=g/(p[o-1]=w))*d+(M=v/w)*b,x=-M*d+u*b,c=0;c<s;c++)b=m[c][o-1],w=m[c][o],m[c][o-1]=b*u+w*M,m[c][o]=-b*M+w*u}l[f]=0,l[a]=g,p[a]=x}for(o=0;o<p.length;o++)p[o]<i&&(p[o]=0);for(o=0;o<h;o++)for(c=o-1;0<=c;c--)if(p[c]<p[o]){for(u=p[c],p[c]=p[o],p[o]=u,a=0;a<m.length;a++)e=m[a][o],m[a][o]=m[a][c],m[a][c]=e;for(a=0;a<y.length;a++)e=y[a][o],y[a][o]=y[a][c],y[a][c]=e;o=c}return{U:m,S:p,V:y}};